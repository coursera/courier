@args org.coursera.courier.py3.Py3Syntax.Py3UnionSyntax union, int indentation
@import org.coursera.courier.py3.Py3Syntax.Py3UnionSyntax
@import org.coursera.courier.py3.Py3Syntax.Py3UnionMemberSyntax

@{ String singleIndent = "    " }

@macro("indent") {@for(int i = 0; i < indentation; i++) {@singleIndent}}

@union.imports()

@indent()class @union.typeName():
@indent()    AVRO_SCHEMA = courier.parse_avro_schema(@union.avroSchemaJson());
@indent()
@indent()    def __init__(self, data):
@indent()        """ Create a @union.typeName() from a dict (probably loaded from json).
@indent()
@indent()        You probably want to use the `create` method instead.
@indent()
@indent()        The dict must have one of these keys: @for(Py3UnionMemberSyntax member: union.members()) {
@indent()            - '@member.unionMemberKey()'
@indent()        }
@indent()        """
@indent()        self.data = data
@indent()
@indent()    @@classmethod
@indent()    def create(cls, value):
@indent()        data_value = courier.data_value(value)
@indent()      @for(Py3UnionMemberSyntax member: union.members()) {        if isinstance(value, @member.typeName()):
@indent()            return cls(data={ '@member.unionMemberKey()': data_value })
@indent()     }
@indent()
@indent()        raise courier.ValidationError('%s was not a valid option for @(union.typeName())' % value)
            @for(Py3UnionMemberSyntax member: union.members()) {
@indent()
@indent()    #
@indent()    # '@member.typeName()' union member
@indent()    #
@indent()    @@property
@indent()    def @(member.accessorName())(self):
@indent()        member_data = self.data.get('@member.unionMemberKey()')
@indent()        return member_data and @(member.constructor())(member_data)
@indent()
@indent()}
@indent()
@indent()    def __repr__(self):
@indent()        return '@(union.typeName())(' + repr(self.data) + ')';
@indent()
@indent()    def __eq__(self, other):
@indent()        return isinstance(other, @(union.typeName())) and self.data == other.data
@indent()
@indent()
